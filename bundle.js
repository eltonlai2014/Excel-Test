"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var lodash=_interopDefault(require("lodash")),log4js=_interopDefault(require("log4js")),exceljs=_interopDefault(require("exceljs")),canvas=_interopDefault(require("canvas"));class DrawLib{drawString(t,e,i,a,r,l,h,s,o,n){s=s||"#000000",n=n||"bottom",o=o||"left",l=l||"Arial",h=h||"",t.save(),t.fillStyle=s,t.font=h+" "+r+"pt "+l,t.textAlign=o,t.textBaseline=n,i=Math.round(i),a=Math.round(a),t.fillText(e,i,a);s=t.measureText(e).width;return t.restore(),s}drawBgString(t,e,i,a,r,l,h,s,o,n,g){o=o||"#999999",t.font=(h=h||"")+" "+r+"pt "+l;var c=t.measureText(e).width,C=t.measureText("Ag").emHeightAscent,d=(i=Math.round(i),(a=Math.round(a))-C-3),C=C+3;return t.beginPath(),"right"==n?t.rect(i-c-2,d,c+4,C):"left"==n?t.rect(i-2,d,c+4,C):t.rect(i-2-c/2,d,c+4,C),t.fillStyle=o,t.fill(),this.drawString(t,e,i,a,r,l,h,s,n,g)+4}drawBgStringRoundRect(t,e,i,a,r,l,h,s,o,n,g){o=o||"#999999",t.font=(h=h||"")+" "+r+"pt "+l;var c=t.measureText(e).width,C=t.measureText("Ag").emHeightAscent,d=(i=Math.round(i),(a=Math.round(a))-C-3),C=C+3;return t.beginPath(),"right"==n?this.drawRoundRect(t,i-c-2,d,c+4,C,4,!0,o):"left"==n?this.drawRoundRect(t,i-2,d,c+4,C,4,!0,o):this.drawRoundRect(t,i-2-c/2,d,c+4,C,4,!0,o),t.fillStyle=o,t.fill(),this.drawString(t,e,i,a,r,l,h,s,n,g)+4}drawRoundRect(t,e,i,a,r,l,h,s,o,n){void 0===o&&(o=!1),void 0===h&&(h=!1),void 0===l&&(l=4),n=n||1,e=Math.round(e),i=Math.round(i),t.save(),t.translate(.5,.5),t.beginPath(),t.moveTo(e+l,i),t.lineTo(e+a-l,i),t.quadraticCurveTo(e+a,i,e+a,i+l),t.lineTo(e+a,i+r-l),t.quadraticCurveTo(e+a,i+r,e+a-l,i+r),t.lineTo(e+l,i+r),t.quadraticCurveTo(e,i+r,e,i+r-l),t.lineTo(e,i+l),t.quadraticCurveTo(e,i,e+l,i),t.lineWidth=n,t.closePath(),o&&t.stroke(),h&&(t.fillStyle=s,t.fill()),t.restore()}dashedLineTo(t,e,i,a,r,l,h,s){s=s||[3,3],t.save(),t.setLineDash(s),this.clearLineTo(t,e,i,a,r,l,h),t.restore()}clearLineTo(t,e,i,a,r,l,h){h=h||1,l=l||"#000000",t.save(),t.translate(.5,.5),e=Math.round(e),i=Math.round(i),a=Math.round(a),r=Math.round(r),t.beginPath(),t.moveTo(e,i),t.lineTo(a,r),t.lineWidth=h,t.strokeStyle=l,t.stroke(),t.restore()}drawLineNoAliasing(e,i,a,t,r,l){l=l||"#FFFFFF";var h=this.DBP(i,a,t,r),s=this.getAngle(t-i,r-a);e.save(),e.fillStyle=l;for(let t=0;t<h;t++)e.fillRect(Math.round(i+Math.cos(s)*t),Math.round(a+Math.sin(s)*t),1,1);e.restore()}drawRectEx(t,e,i,a,r,l,h){this.clearLineTo(t,e,i,e+a,i,l,h),this.clearLineTo(t,e+a,i,e+a,i+r,l,h),this.clearLineTo(t,e+a,i+r,e,i+r,l,h),this.clearLineTo(t,e,i+r,e,i,l,h)}fillRectEx(t,e,i,a,r,l){t.beginPath(),t.rect(Math.round(e),Math.round(i),Math.round(a),Math.round(r)),t.fillStyle=l,t.fill(),t.closePath()}getPrettyUnit(t,e){var i=Math.pow(10,Math.floor(Math.log10(t))),a=Math.pow(10,Math.ceil(Math.log10(t)));return a<=10?t<4.5*i?a/2:a:1.1*t/i<=(e=e||7.5)?Math.ceil(1.1*t/i)*i-i/2:a}quickSort(i){if(i.length<=1)return i;var t=Math.floor(i.length/2),a=i.splice(t,1)[0],r=[],l=[];for(let t=0,e=i.length;t<e;t++)(i[t]<a?r:l).push(i[t]);return this.quickSort(r).concat([a],this.quickSort(l))}DBP(t,e,i,a){return Math.sqrt((i-t)*(i-t)+(a-e)*(a-e))}getAngle(t,e){return Math.atan(e/(0===t?.01:t))+(t<0?Math.PI:0)}getMonthWeek(t,e,i){t=new Date(t,parseInt(e,10)-1,i),e=t.getDay(),i=t.getDate();return Math.ceil((i+6-e)/7)}getYearWeek(t,e,i){e=new Date(t,parseInt(e)-1,i),i=new Date(t,0,1),t=Math.round((e.valueOf()-i.valueOf())/864e5);return Math.floor((t+i.getDay())/7)}rgbToHex(t,e,i){return"#"+((1<<24)+(t<<16)+(e<<8)+i).toString(16).slice(1)}hexToRgb(t){t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}setChartData(t){console.log("CommonChart setChartData ...")}}var DrawLib_1=DrawLib;const logger=log4js.getLogger("CommonChart"),{createCanvas,loadImage}=canvas;class CommonChart extends DrawLib_1{constructor(t,e,i){super(),this.cWidth=t,this.cHeight=e,this.init(i)}init(t){logger.info("CommonChart init"),this.leftWidth=t.leftWidth||50,this.rightWidth=t.rightWidth||20,this.chartWidth=this.cWidth-this.leftWidth-this.rightWidth,this.topHeight=t.topHeight||50,this.bottomHeight=t.bottomHeight||20,this.chartHeight=this.cHeight-this.topHeight-this.bottomHeight,this.canvas=createCanvas(this.cWidth,this.cHeight),this.context=this.canvas.getContext("2d")}getChartInfo(){return this.chartWidth+" "+this.chartHeight}getCanvasBuffer(t){return this.canvas.toBuffer(t=t||"image/png")}setChartData(t){console.log("CommonChart setChartData ...")}}var CommonChart_1=CommonChart;const logger$1=log4js.getLogger("SiteChart");class SiteChart extends CommonChart_1{constructor(t,e,i){super(t,e,i),this.myInit(i)}myInit(t){logger$1.info("SiteChart init"),this.chartColor=t.chartColor||["#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#229B2F","#6495ED"],this.chartLineWidth=t.chartLineWidth||4}setChartData(t,e){e=e||SiteChart.Type.COMPANY,logger$1.info("SiteChart setChartData ..."),super.setChartData(t),this.chartData=t.data,this.chartTitle=t.title;for(let t=this.maxValue=0;t<this.chartData.length;t++){var i=this.chartData[t];e==SiteChart.Type.COMPANY?(i.Total=i.Health+i.Warning+i.Critical,this.maxValue=Math.max(this.maxValue,i.Total)):e==SiteChart.Type.SITES&&(this.maxValue=Math.max(this.maxValue,i.Warning),this.maxValue=Math.max(this.maxValue,i.Critical))}return this.chartData=lodash.sortBy(this.chartData,["Month"]),console.log("data",this.chartData,this.maxValue),this.axisY_Max=this.getPrettyUnit(this.maxValue),this}getChartInfo(){console.log(this.leftWidth,this.chartWidth,this.rightWidth),console.log(this.topHeight,this.chartHeight,this.bottomHeight)}paint(e){logger$1.info("SiteChart paint ..."),e=e||["Health","Warning","Critical","Total"],this.getChartInfo();var l="#ffffff",h=this.context,t=(h.fillStyle=l,h.fillRect(0,0,this.cWidth,this.cHeight),"#AAAAAA"),i=(this.clearLineTo(h,0,0,this.cWidth,0,t,1),this.clearLineTo(h,0,this.cHeight-1,this.cWidth,this.cHeight-1,t,1),this.clearLineTo(h,0,0,0,this.cHeight-1,t,1),this.clearLineTo(h,this.cWidth-1,0,this.cWidth-1,this.cHeight-1,t,1),this.chartTitle&&this.drawString(h,this.chartTitle,this.cWidth/2,this.topHeight/2+4,16,"Arial","","#333333","center","middle"),"#CCCCCC"),s=(this.clearLineTo(h,this.leftWidth-1,this.topHeight,this.leftWidth-1,this.topHeight+this.chartHeight,i,1),this.clearLineTo(h,this.leftWidth-1,this.topHeight+this.chartHeight,this.cWidth-this.rightWidth,this.topHeight+this.chartHeight,i,1),"Arial"),o="#333333";for(let t=0;t<5;t++){const S=this.topHeight+t*this.chartHeight/5;0<t&&this.clearLineTo(h,this.leftWidth-1,S,this.cWidth-this.rightWidth,S,i,1),this.drawString(h,(5-t)*this.axisY_Max/5,this.leftWidth-4,S,10,s,"",o,"right","middle")}this.drawString(h,"0",this.leftWidth-4,this.topHeight+this.chartHeight+2,10,s,"",o,"right","bottom"),this.drawString(h,"Sites",this.leftWidth-4,this.topHeight+this.chartHeight+18,10,s,"",o,"right","top"),h.save();var n=this.chartWidth/this.chartData.length;for(let r=0;r<e.length;r++){var g=e[r];if(1==this.chartData.length){var a=this.chartData[0],c=this.chartWidth/(e.length+2),C=this.leftWidth+(r+1.5)*c,d=a[g]/this.axisY_Max*this.chartHeight;this.fillRectEx(h,C-.3*c,this.topHeight+this.chartHeight,.6*c,-d,this.chartColor[r%this.chartColor.length]);const S=this.topHeight+this.chartHeight-d-4;this.drawBgString(h,a[g],C,S,10,s,"",o,l,"center","bottom"),0==r&&this.drawString(h,a.Month,this.leftWidth+this.chartWidth/2,this.topHeight+this.chartHeight+18,10,s,"",o,"center","top")}else{let e=null,i=null;for(let t=0;t<this.chartData.length;t++){var u=this.chartData[t],f=this.leftWidth+(t+.5)*n,u=this.topHeight+(this.axisY_Max-u[g])/this.axisY_Max*this.chartHeight;null!=e&&null!=i&&this.clearLineTo(h,e,i,f,u,this.chartColor[r%this.chartColor.length],this.chartLineWidth),e=f,i=u}let a=!1;6<this.chartData.length&&(a=!0);for(let e=0;e<this.chartData.length;e++){var v=this.chartData[e],p=this.leftWidth+(e+.5)*n,m=this.topHeight+(this.axisY_Max-v[g])/this.axisY_Max*this.chartHeight;let t=-4;if(r%2==0&&(t=20),this.drawBgString(h,v[g],p,m+t,10,s,"",this.chartColor[r%this.chartColor.length],l,"center","bottom"),0==r){let t=v.Month.toString();a&&6==t.length&&(t=t.substring(4)),this.drawString(h,t,p,this.topHeight+this.chartHeight+18,10,s,"",o,"center","top")}}}}let S=this.cHeight-16;for(let t=0;t<e.length;t++){var r=this.leftWidth+this.chartWidth/e.length*t;this.drawString(h,e[t],r+30+4,S,10,s,"",o,"left","moddle"),this.fillRectEx(h,r,S-6-2,30,6,this.chartColor[t])}return h.restore(),this}}SiteChart.Type={},SiteChart.Type.COMPANY=0,SiteChart.Type.SITES=1;var SiteChart_1=SiteChart;const logger$2=log4js.getLogger("ReportExcel");class ReportExcel{constructor(t){this.options=t}getParamValue(t,e){return null!=this.options[t]?this.options[t]:e}genReport(ht){const st=(t,e,i,a,r,l)=>{t=t.getCell(i);return t.style=e%2==0?r:l,t.value=a=null==a?"":a,t},ot=(t,e,i,a)=>{t=t.getCell(e);return t.style=a,t.value=i,t},nt=e=>{var i={};for(let t=0;t<e.RankList.length;t++){var a=e.RankList[t].EventType,r=e.RankList[t].Rank;i[a]=r}return i},gt=(t,e,i)=>{let a=t[e];return null!=(a=null==a?[]:a)[i]?a[i]:{SiteId:"",SiteName:""}};return new Promise(async(P,O)=>{this.report=ht,logger$2.info("ReportExcel init",this.options);let t=11;var e=this.getParamValue("OperationBlock",!0),i=this.getParamValue("NetworkDeviceBlock",!0),_=this.getParamValue("CriticalEventBlock",!0),I=this.getParamValue("WarningEventBlock",!0),a=(e&&(t+=16+ht.reportData.data.length),i&&(t+=16+ht.reportData2.data.length),_&&(t+=41),I&&(t+=41),this.workbook=new exceljs.Workbook,await this.workbook.xlsx.readFile(this.options.StyleFile),this.workbook.getWorksheet(this.options.StyleSheet)),r=new SiteChart_1(this.options.chartOptions.chartWidth||540,this.options.chartOptions.chartHeight||300,this.options.chartOptions),F=[];for(let t=1;t<=20;t++){var $=a.getColumn(t);F.push($.width)}console.log("colWidth",F);var V=a.getCell("B1").style,Y=a.getCell("B2").style,l=a.getCell("H3").style,q=a.getCell("C7").style,h=a.getCell("C12").style,j=(a.getCell("F12").style,a.getCell("C23").style,a.getCell("C24").style),X=a.getCell("D23").style,s=a.getCell("D24").style,o=a.getCell("C52").style,n=a.getCell("D52").style,g=a.getCell("C53").style,c=a.getCell("D53").style,C=a.getCell("C54").style,d=a.getCell("D54").style,u=this.workbook.addWorksheet("台電測試站",{pageSetup:{paperSize:12}});for(let t=1;t<=20;t++)u.getColumn(t).width=F[t-1];var G=t+1;for(let t=1;t<=200;t++){var U=u.getRow(t);for(let t=1;t<=20;t++)U.getCell(t).style=V;if(1<t&&t<G)for(let t=2;t<=14;t++)U.getCell(t).style=Y}let f=3,v=u.getRow(f),p=v.getCell(8);p.value="公司報表_台電",p.style=l,p.font=l.font;for(let t=f+=2;t<f+5;t++){var z=u.getRow(t);for(let t=3;t<=13;t++)z.getCell(t).style=q;switch(t){case f+1:u.mergeCells(`C${t}:F`+t),z.getCell(3).value="  公司　"+ht.companyName;break;case f+2:u.mergeCells(`C${t}:F`+t),z.getCell(3).value="  報表產生時間　"+ht.reportDate;break;case f+3:u.mergeCells(`C${t}:F`+t),z.getCell(3).value=`  報告內容時間　${ht.reportSDate}~`+ht.reportEate}}if(f=f+5+2,e){v=u.getRow(f),u.mergeCells(`C${f}:M`+f),(p=v.getCell(3)).value="站台營運服務狀態",p.style=h;var l=f+1,J=["  各站台 MXview 主機營運狀況","  以是否發生 MXview One Server Alert 區分","  Critical Site  當月發生過 Critical Event","  Warning Site  當月未發生Critical Event 但有 Warning Event","  Health Site  當月未發生 Critical Event 和 Warning Event"];for(let t=f+=2;t<f+7;t++){var K=u.getRow(t);for(let t=3;t<=7;t++)K.getCell(t).style=q;switch(t){case f+1:case f+2:case f+3:case f+4:case f+5:u.mergeCells(`C${t}:G`+t),K.getCell(3).value=J[t-f-1]}}f=f+7+2;var Q=["","Health Site","Warning Site","Critical Site","Total"];for(let t=0;t<ht.reportData.data.length;t++){var Z=ht.reportData.data[t];Z.Total=Z.Health+Z.Warning+Z.Critical}ht.reportData.data=lodash.sortBy(ht.reportData.data,["Month"]);for(let t=f;t<=f+(ht.reportData.data.length+1);t++){var m=u.getRow(t);if(t===f)for(let t=0;t<5;t++){var tt=m.getCell(t+3);tt.value=Q[t],tt.style=X}else{var S=ht.reportData.data[t-f-1];if(S){let t=m.getCell(3);t.style=j,t.value=S.Month,(t=m.getCell(4)).style=s,t.value=S.Health,(t=m.getCell(5)).style=s,t.value=S.Warning,(t=m.getCell(6)).style=s,t.value=S.Critical,(t=m.getCell(7)).style=s,t.value=S.Total}}}r.setChartData(ht.reportData,SiteChart_1.Type.COMPANY).paint();e=r.getCanvasBuffer(),e=this.workbook.addImage({buffer:e,extension:"png"});u.addImage(e,{tl:{col:7.5,row:l},ext:{width:this.options.chartOptions.chartWidth,height:this.options.chartOptions.chartHeight}}),f=f+ht.reportData.data.length+5}if(i){v=u.getRow(f),u.mergeCells(`C${f}:M`+f),(p=v.getCell(3)).value="站台網路及設備監控狀態",p.style=h;var e=f+1,et=["  各站台網路及設備狀況","  以是否發生 MXview One Server Alert 之外的 Alert 區分","  Critical Site  當月發生過 Critical Event","  Warning Site  當月未發生Critical Event 但有 Warning Event","  Health Site  當月未發生 Critical Event 和 Warning Event"];for(let t=f+=2;t<f+7;t++){var it=u.getRow(t);for(let t=3;t<=7;t++)it.getCell(t).style=q;switch(t){case f+1:case f+2:case f+3:case f+4:case f+5:u.mergeCells(`C${t}:G`+t),it.getCell(3).value=et[t-f-1]}}f=f+7+2;var at=["","Health Site","Warning Site","Critical Site","Total"];for(let t=0;t<ht.reportData2.data.length;t++){var rt=ht.reportData2.data[t];rt.Total=rt.Health+rt.Warning+rt.Critical}ht.reportData2.data=lodash.sortBy(ht.reportData2.data,["Month"]);for(let t=f;t<=f+(ht.reportData2.data.length+1);t++){var w=u.getRow(t);if(t===f)for(let t=0;t<5;t++){var lt=w.getCell(t+3);lt.value=at[t],lt.style=X}else{var T=ht.reportData2.data[t-f-1];if(T){let t=w.getCell(3);t.style=j,t.value=T.Month,(t=w.getCell(4)).style=s,t.value=T.Health,(t=w.getCell(5)).style=s,t.value=T.Warning,(t=w.getCell(6)).style=s,t.value=T.Critical,(t=w.getCell(7)).style=s,t.value=T.Total}}}r.setChartData(ht.reportData2,SiteChart_1.Type.COMPANY).paint();l=r.getCanvasBuffer(),i=this.workbook.addImage({buffer:l,extension:"png"});u.addImage(i,{tl:{col:7.5,row:e},ext:{width:this.options.chartOptions.chartWidth,height:this.options.chartOptions.chartHeight}}),f=f+ht.reportData2.data.length+5}if(_){var D=nt(ht.reportData3);v=u.getRow(f),u.mergeCells(`C${f}:M`+f),(p=v.getCell(3)).value="Critical Event 發生次數 Top 10",p.style=h;for(let t=f+=2;t<=f+10;t++){var y,W=u.getRow(t);t==f?(ot(W,3,"Site",o),ot(W,4,"Total",n),ot(W,6,"Site",o),ot(W,7,"Device unreachable",n),ot(W,9,"Site",o),ot(W,10,"Network alert",n),ot(W,12,"Site",o),ot(W,13,"Ethernet port alert",n)):(y=gt(D,99,t-f-1),st(W,t-f,3,y.SiteName,C,g),st(W,t-f,4,y.Times,d,c),y=gt(D,1,t-f-1),st(W,t-f,6,y.SiteName,C,g),st(W,t-f,7,y.Times,d,c),y=gt(D,2,t-f-1),st(W,t-f,9,y.SiteName,C,g),st(W,t-f,10,y.Times,d,c),y=gt(D,3,t-f-1),st(W,t-f,12,y.SiteName,C,g),st(W,t-f,13,y.Times,d,c))}for(let t=f+=13;t<=f+10;t++){var M,x=u.getRow(t);t==f?(ot(x,3,"Site",o),ot(x,4,"Fiber port alert",n),ot(x,6,"Site",o),ot(x,7,"Power supply alert",n),ot(x,9,"Site",o),ot(x,10,"Network intrusion alert",n),ot(x,12,"Site",o),ot(x,13,"Device security alert",n)):(M=gt(D,4,t-f-1),st(x,t-f,3,M.SiteName,C,g),st(x,t-f,4,M.Times,d,c),M=gt(D,5,t-f-1),st(x,t-f,6,M.SiteName,C,g),st(x,t-f,7,M.Times,d,c),M=gt(D,6,t-f-1),st(x,t-f,9,M.SiteName,C,g),st(x,t-f,10,M.Times,d,c),M=gt(D,7,t-f-1),st(x,t-f,12,M.SiteName,C,g),st(x,t-f,13,M.Times,d,c))}for(let t=f+=13;t<=f+10;t++){var H,R=u.getRow(t);t==f?(ot(R,3,"Site",o),ot(R,4,"Device Status Alert",n),ot(R,6,"Site",o),ot(R,7,"MXview One Server Alert",n),ot(R,9,"Site",o),ot(R,10,"GOOSE",n)):(H=gt(D,8,t-f-1),st(R,t-f,3,H.SiteName,C,g),st(R,t-f,4,H.Times,d,c),H=gt(D,9,t-f-1),st(R,t-f,6,H.SiteName,C,g),st(R,t-f,7,H.Times,d,c),H=gt(D,10,t-f-1),st(R,t-f,9,H.SiteName,C,g),st(R,t-f,10,H.Times,d,c))}f+=13}if(I){var k=nt(ht.reportData4);v=u.getRow(f),u.mergeCells(`C${f}:M`+f),(p=v.getCell(3)).value="Warning Event 發生次數 Top 10",p.style=h;for(let t=f+=2;t<=f+10;t++){var b,N=u.getRow(t);t==f?(ot(N,3,"Site",o),ot(N,4,"Total",n),ot(N,6,"Site",o),ot(N,7,"Device unreachable",n),ot(N,9,"Site",o),ot(N,10,"Network alert",n),ot(N,12,"Site",o),ot(N,13,"Ethernet port alert",n)):(b=gt(k,99,t-f-1),st(N,t,3,b.SiteName,C,g),st(N,t,4,b.Times,d,c),b=gt(k,1,t-f-1),st(N,t,6,b.SiteName,C,g),st(N,t,7,b.Times,d,c),b=gt(k,2,t-f-1),st(N,t,9,b.SiteName,C,g),st(N,t,10,b.Times,d,c),b=gt(k,3,t-f-1),st(N,t,12,b.SiteName,C,g),st(N,t,13,b.Times,d,c))}for(let t=f+=13;t<=f+10;t++){var E,A=u.getRow(t);t==f?(ot(A,3,"Site",o),ot(A,4,"Fiber port alert",n),ot(A,6,"Site",o),ot(A,7,"Power supply alert",n),ot(A,9,"Site",o),ot(A,10,"Network intrusion alert",n),ot(A,12,"Site",o),ot(A,13,"Device security alert",n)):(E=gt(k,4,t-f-1),st(A,t,3,E.SiteName,C,g),st(A,t,4,E.Times,d,c),E=gt(k,5,t-f-1),st(A,t,6,E.SiteName,C,g),st(A,t,7,E.Times,d,c),E=gt(k,6,t-f-1),st(A,t,9,E.SiteName,C,g),st(A,t,10,E.Times,d,c),E=gt(k,7,t-f-1),st(A,t,12,E.SiteName,C,g),st(A,t,13,E.Times,d,c))}for(let t=f+=13;t<=f+10;t++){var L,B=u.getRow(t);t==f?(ot(B,3,"Site",o),ot(B,4,"Device Status Alert",n),ot(B,6,"Site",o),ot(B,7,"MXview One Server Alert",n),ot(B,9,"Site",o),ot(B,10,"GOOSE",n)):(L=gt(k,8,t-f-1),st(B,t,3,L.SiteName,C,g),st(B,t,4,L.Times,d,c),L=gt(k,9,t-f-1),st(B,t,6,L.SiteName,C,g),st(B,t,7,L.Times,d,c),L=gt(k,10,t-f-1),st(B,t,9,L.SiteName,C,g),st(B,t,10,L.Times,d,c))}f+=13}v=u.getRow(f),(p=v.getCell(3)).value="==========================================================================================",console.log("startRow",f),this.workbook.removeWorksheet(a.id),P(!0)})}async getReportBuffer(){return null!=this.workbook?await this.workbook.xlsx.writeBuffer():null}}var ReportExcel_1=ReportExcel;module.exports=ReportExcel_1;
